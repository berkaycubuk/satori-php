<?php

use Choowx\Satori\Font;
use Choowx\Satori\Satori;

it('can convert to svg', function () {
    $svg = Satori::html('<div style="color: black">hello, world</div>')->convert();

    expect($svg)->toBe(
        '<svg width="1200" height="630" viewBox="0 0 1200 630" xmlns="http://www.w3.org/2000/svg"><path fill="black" d="M2.8 4.7L2.8 8.3Q2.8 8.9 2.7 9.5L2.7 9.5L2.8 9.5Q3.2 8.8 3.9 8.5Q4.6 8.1 5.5 8.1L5.5 8.1Q7.0 8.1 7.8 8.9Q8.6 9.6 8.6 11.3L8.6 11.3L8.6 16.9L7.2 16.9L7.2 11.4Q7.2 9.3 5.3 9.3L5.3 9.3Q3.8 9.3 3.3 10.1Q2.8 10.9 2.8 12.4L2.8 12.4L2.8 16.9L1.4 16.9L1.4 4.7L2.8 4.7ZM14.6 8.1L14.6 8.1Q15.7 8.1 16.5 8.6Q17.2 9.1 17.7 10.0Q18.1 10.8 18.1 12.0L18.1 12.0L18.1 12.8L12.2 12.8Q12.3 14.3 13.0 15.1Q13.7 15.8 15.0 15.8L15.0 15.8Q15.8 15.8 16.4 15.7Q17.0 15.5 17.7 15.2L17.7 15.2L17.7 16.5Q17.1 16.7 16.4 16.9Q15.8 17.0 14.9 17.0L14.9 17.0Q13.7 17.0 12.7 16.5Q11.8 16.0 11.3 15.0Q10.8 14.1 10.8 12.6L10.8 12.6Q10.8 11.2 11.2 10.2Q11.7 9.2 12.6 8.7Q13.4 8.1 14.6 8.1ZM14.5 9.3L14.5 9.3Q13.5 9.3 13.0 9.9Q12.4 10.6 12.3 11.7L12.3 11.7L16.6 11.7Q16.6 10.6 16.1 10.0Q15.6 9.3 14.5 9.3ZM21.7 4.7L21.7 16.9L20.3 16.9L20.3 4.7L21.7 4.7ZM25.8 4.7L25.8 16.9L24.4 16.9L24.4 4.7L25.8 4.7ZM36.0 12.6L36.0 12.6Q36.0 14.7 34.9 15.9Q33.8 17.0 32.0 17.0L32.0 17.0Q30.8 17.0 30.0 16.5Q29.1 16.0 28.6 15.0Q28.0 14.0 28.0 12.6L28.0 12.6Q28.0 10.4 29.1 9.3Q30.2 8.1 32.0 8.1L32.0 8.1Q33.2 8.1 34.1 8.6Q35.0 9.2 35.5 10.1Q36.0 11.1 36.0 12.6ZM29.5 12.6L29.5 12.6Q29.5 14.1 30.1 15.0Q30.7 15.9 32.0 15.9L32.0 15.9Q33.3 15.9 33.9 15.0Q34.5 14.1 34.5 12.6L34.5 12.6Q34.5 11.0 33.9 10.2Q33.3 9.3 32 9.3L32 9.3Q30.7 9.3 30.1 10.2Q29.5 11.0 29.5 12.6ZM39.8 15.0L39.9 15.2Q39.7 16.0 39.3 17.0Q38.9 18.1 38.5 18.9L38.5 18.9L37.5 18.9Q37.7 18.0 38.0 16.9Q38.2 15.8 38.3 15.0L38.3 15.0L39.8 15.0Z M53.7 16.8L52.2 12.0Q52.0 11.4 51.8 10.7Q51.7 10.1 51.6 9.7L51.6 9.7L51.5 9.7Q51.5 10.1 51.3 10.7Q51.2 11.4 51.0 12.0L51.0 12.0L49.4 16.8L47.8 16.8L45.5 8.3L46.9 8.3L48.1 12.8Q48.3 13.5 48.4 14.2Q48.6 14.9 48.7 15.4L48.7 15.4L48.7 15.4Q48.8 15.1 48.9 14.7Q49.0 14.3 49.1 13.9Q49.2 13.5 49.3 13.1L49.3 13.1L50.8 8.3L52.4 8.3L53.8 13.1Q54.0 13.6 54.2 14.3Q54.4 14.9 54.4 15.4L54.4 15.4L54.5 15.4Q54.5 15.0 54.7 14.3Q54.9 13.6 55.1 12.8L55.1 12.8L56.3 8.3L57.7 8.3L55.3 16.8L53.7 16.8ZM66.7 12.6L66.7 12.6Q66.7 14.7 65.6 15.9Q64.5 17.0 62.7 17.0L62.7 17.0Q61.6 17.0 60.7 16.5Q59.8 16.0 59.3 15.0Q58.8 14.0 58.8 12.6L58.8 12.6Q58.8 10.4 59.8 9.3Q60.9 8.1 62.7 8.1L62.7 8.1Q63.9 8.1 64.8 8.6Q65.7 9.2 66.2 10.1Q66.7 11.1 66.7 12.6ZM60.2 12.6L60.2 12.6Q60.2 14.1 60.8 15.0Q61.4 15.9 62.7 15.9L62.7 15.9Q64.0 15.9 64.6 15.0Q65.2 14.1 65.2 12.6L65.2 12.6Q65.2 11.0 64.6 10.2Q64.0 9.3 62.7 9.3L62.7 9.3Q61.4 9.3 60.8 10.2Q60.2 11.0 60.2 12.6ZM72.9 8.1L72.9 8.1Q73.2 8.1 73.4 8.1Q73.7 8.2 73.9 8.2L73.9 8.2L73.7 9.5Q73.5 9.5 73.3 9.4Q73.0 9.4 72.8 9.4L72.8 9.4Q72.2 9.4 71.6 9.8Q71.0 10.1 70.7 10.8Q70.3 11.4 70.3 12.3L70.3 12.3L70.3 16.9L68.9 16.9L68.9 8.3L70.1 8.3L70.2 9.9L70.3 9.9Q70.7 9.1 71.4 8.6Q72.0 8.1 72.9 8.1ZM76.9 4.7L76.9 16.9L75.5 16.9L75.5 4.7L76.9 4.7ZM82.7 17.0L82.7 17.0Q81.1 17.0 80.1 15.9Q79.2 14.8 79.2 12.6L79.2 12.6Q79.2 10.4 80.1 9.3Q81.1 8.1 82.7 8.1L82.7 8.1Q83.7 8.1 84.3 8.5Q85.0 8.9 85.4 9.4L85.4 9.4L85.5 9.4Q85.4 9.2 85.4 8.8Q85.4 8.4 85.4 8.1L85.4 8.1L85.4 4.7L86.8 4.7L86.8 16.9L85.6 16.9L85.4 15.7L85.4 15.7Q85.0 16.3 84.3 16.6Q83.7 17.0 82.7 17.0ZM82.9 15.9L82.9 15.9Q84.3 15.9 84.8 15.1Q85.4 14.4 85.4 12.9L85.4 12.9L85.4 12.6Q85.4 11.0 84.8 10.1Q84.3 9.3 82.9 9.3L82.9 9.3Q81.8 9.3 81.2 10.2Q80.6 11.1 80.6 12.6L80.6 12.6Q80.6 14.2 81.2 15.0Q81.8 15.9 82.9 15.9Z "/></svg>'
    );
});

it('can convert to svg in specified width', function () {
    $svg = Satori::html('<div style="color: black">hello, world</div>')
        ->width(600)
        ->convert();

    expect($svg)->toContain('width="600"');
});

it('can convert to svg in specified height', function () {
    $svg = Satori::html('<div style="color: black">hello, world</div>')
        ->height(500)
        ->convert();

    expect($svg)->toContain('height="500"');
});

it('can convert to svg with custom font', function () {
    $svg = Satori::html('<div style="color: black">hello, world</div>')
        ->withFonts([Font::path(__DIR__.'/fonts/Roboto-Regular.ttf')])
        ->convert();

    expect($svg)->toBe(
        '<svg width="1200" height="630" viewBox="0 0 1200 630" xmlns="http://www.w3.org/2000/svg"><path fill="black" d="M2.5 3.5L2.5 8.1Q3.5 6.9 5.0 6.9L5.0 6.9Q7.7 6.9 7.7 9.9L7.7 9.9L7.7 15.5L6.3 15.5L6.3 9.9Q6.3 9.0 5.9 8.5Q5.5 8.1 4.6 8.1L4.6 8.1Q3.9 8.1 3.4 8.5Q2.8 8.9 2.5 9.5L2.5 9.5L2.5 15.5L1.1 15.5L1.1 3.5L2.5 3.5ZM13.4 15.6L13.4 15.6Q11.7 15.6 10.6 14.5Q9.5 13.4 9.5 11.5L9.5 11.5L9.5 11.2Q9.5 10.0 10.0 9.0Q10.5 8.0 11.4 7.4Q12.2 6.9 13.2 6.9L13.2 6.9Q14.9 6.9 15.8 8.0Q16.7 9.0 16.7 11.1L16.7 11.1L16.7 11.7L11.0 11.7Q11.0 12.9 11.7 13.7Q12.4 14.5 13.5 14.5L13.5 14.5Q14.3 14.5 14.8 14.1Q15.3 13.8 15.7 13.3L15.7 13.3L16.6 14.0Q15.5 15.6 13.4 15.6ZM13.2 8.1L13.2 8.1Q12.4 8.1 11.8 8.7Q11.2 9.3 11.0 10.5L11.0 10.5L15.3 10.5L15.3 10.4Q15.2 9.3 14.7 8.7Q14.1 8.1 13.2 8.1ZM20.0 3.5L20.0 15.5L18.5 15.5L18.5 3.5L20.0 3.5ZM23.8 3.5L23.8 15.5L22.4 15.5L22.4 3.5L23.8 3.5ZM25.8 11.3L25.8 11.2Q25.8 9.9 26.3 8.9Q26.7 8.0 27.6 7.4Q28.5 6.9 29.6 6.9L29.6 6.9Q31.3 6.9 32.4 8.1Q33.5 9.3 33.5 11.2L33.5 11.2L33.5 11.4Q33.5 12.6 33.0 13.6Q32.5 14.5 31.6 15.1Q30.8 15.6 29.6 15.6L29.6 15.6Q27.9 15.6 26.8 14.4Q25.8 13.2 25.8 11.3L25.8 11.3ZM27.2 11.4L27.2 11.4Q27.2 12.8 27.9 13.6Q28.5 14.5 29.6 14.5L29.6 14.5Q30.7 14.5 31.4 13.6Q32.0 12.7 32.0 11.2L32.0 11.2Q32.0 9.8 31.4 8.9Q30.7 8.1 29.6 8.1L29.6 8.1Q28.5 8.1 27.9 8.9Q27.2 9.8 27.2 11.4ZM35.2 17.7L35.2 17.7L34.4 17.2Q35.1 16.2 35.2 15.1L35.2 15.1L35.2 13.8L36.6 13.8L36.6 14.9Q36.6 15.7 36.2 16.5Q35.8 17.3 35.2 17.7Z M47.9 7.0L49.9 13.5L51.5 7.0L52.9 7.0L50.5 15.5L49.3 15.5L47.2 9.1L45.2 15.5L44.1 15.5L41.6 7.0L43.1 7.0L44.7 13.4L46.7 7.0L47.9 7.0ZM54.0 11.3L54.0 11.2Q54.0 9.9 54.5 8.9Q55.0 8.0 55.9 7.4Q56.7 6.9 57.9 6.9L57.9 6.9Q59.6 6.9 60.6 8.1Q61.7 9.3 61.7 11.2L61.7 11.2L61.7 11.4Q61.7 12.6 61.2 13.6Q60.8 14.5 59.9 15.1Q59.0 15.6 57.9 15.6L57.9 15.6Q56.1 15.6 55.1 14.4Q54.0 13.2 54.0 11.3L54.0 11.3ZM55.5 11.4L55.5 11.4Q55.5 12.8 56.1 13.6Q56.8 14.5 57.9 14.5L57.9 14.5Q59.0 14.5 59.6 13.6Q60.3 12.7 60.3 11.2L60.3 11.2Q60.3 9.8 59.6 8.9Q58.9 8.1 57.9 8.1L57.9 8.1Q56.8 8.1 56.1 8.9Q55.5 9.8 55.5 11.4ZM67.6 7.0L67.6 8.3Q67.3 8.3 66.9 8.3L66.9 8.3Q65.5 8.3 65.0 9.5L65.0 9.5L65.0 15.5L63.5 15.5L63.5 7.0L64.9 7.0L65.0 8.0Q65.7 6.9 67.0 6.9L67.0 6.9Q67.4 6.9 67.6 7.0L67.6 7.0ZM70.5 3.5L70.5 15.5L69.1 15.5L69.1 3.5L70.5 3.5ZM72.5 11.3L72.5 11.2Q72.5 9.2 73.4 8.1Q74.3 6.9 75.8 6.9L75.8 6.9Q77.3 6.9 78.2 7.9L78.2 7.9L78.2 3.5L79.6 3.5L79.6 15.5L78.3 15.5L78.2 14.6Q77.3 15.6 75.8 15.6L75.8 15.6Q74.3 15.6 73.4 14.4Q72.5 13.2 72.5 11.3L72.5 11.3ZM73.9 11.4L73.9 11.4Q73.9 12.8 74.5 13.6Q75.1 14.4 76.1 14.4L76.1 14.4Q77.5 14.4 78.2 13.2L78.2 13.2L78.2 9.3Q77.5 8.1 76.2 8.1L76.2 8.1Q75.1 8.1 74.5 8.9Q73.9 9.7 73.9 11.4Z "/></svg>'
    );
});
